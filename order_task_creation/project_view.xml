<openerp>
	<data>
		<record id="view_task_form_sale" model="ir.ui.view">
            <field name="name">project.task.form.sale</field>
            <field name="model">project.task</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <form string="Project">
                    <header>
                        <field name="stage_id" widget="statusbar" clickable="True" domain="[('sales_stage','=', True)]"
                            options="{'fold_field': 'fold'}"/>
                    </header>
                    <sheet string="Task">
                    <div class="oe_button_box" name="button_box">
						<button name="action_view_order"
							type="object"
							class="oe_stat_button"
							icon="fa-usd"
							attrs="{'invisible': [('order_id', '=', False)]}"
							string="Open Sales Order"/>
                        <button name="toggle_active" type="object" groups="base.group_user"
                                class="oe_stat_button" icon="fa-archive">
                            <field name="active" widget="boolean_button"
                                options='{"terminology": "archive"}'/>
                        </button>
                    </div>
                    <field name="kanban_state" widget="kanban_state_selection"/>
                    <div class="oe_title">
                        <h1 class="o_row">
                            <field name="priority" widget="priority"/>
                            <field name="name" placeholder="Task Title..."/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="project_id" domain="[('state','not in', ('close', 'cancelled'))]" on_change="onchange_project(project_id)" context="{'default_use_tasks':1}" attrs="{'invisible': [('sale_task', '=', True)]}"/>
                            <field name="order_id" invisible="True"/>
							<field name="sale_task" invisible="True"/>
							<field name="user_id"
                                options='{"no_open": True}'
                                on_change="onchange_user_id(user_id, context)"
                                context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'project.group_project_user']}"/>
                            <field name="planned_hours" widget="float_time"
                                    groups="project.group_time_work_estimation_tasks"
                                    on_change="onchange_planned(planned_hours)" attrs="{'invisible': [('sale_task', '=', True)]}"/>
                            <field name="legend_blocked" invisible="1"/>
                            <field name="legend_normal" invisible="1"/>
                            <field name="legend_done" invisible="1"/>
                        </group>
                        <group>
                            <field name="date_deadline"/>
                            <field name="tag_ids" widget="many2many_tags" attrs="{'invisible': [('sale_task', '=', True)]}"/>
                        </group>
						<group attrs="{'invisible': [('sale_task', '=', False)]}">

							<field name="refinement_data" widget="radio"/>
							<field name="delivery_billing_adress" widget="radio"/>
							<field name="vallue_tax_id" widget="radio"/>
							<!-- <field name="delivery_date" /> -->
							<!-- <group>
							<group>
							<field name="fix_delivery_date" width="50"  attrs="{'readonly':[('fix','=',True)]}" />
							</group><group>
							<field name="year_week" />
							</group></group> -->
							<label for="delivery_date" />
							<div name="Delivery date">

								<field name="delivery_date" style="width:4em" class="oe_inline"  attrs="{'readonly':[('fix','=',True)]}"/>
								<span style="padding-left:15px;"> KW </span>
								<field name="year_week" style="width: 4em" class="oe_inline"/>

							</div>
							<field name="fix"/>
						</group>
						<group  attrs="{'invisible': [('sale_task', '=', False)]}" >
							<field name="payment" widget="many2many_tags"  groups="project.group_project_manager,project.group_project_user"/>
							<field name="payment_supplier" widget="many2many_tags"  groups="project.group_project_manager,project.group_project_user"/>
							<field name="digital_sample" widget="many2many_tags"  groups="project.group_project_manager,project.group_project_user"/>
							<field name="sample" widget="many2many_tags"  groups="project.group_project_manager,project.group_project_user"/>
							<field name="comment"  groups="project.group_project_manager,project.group_project_user"/>
						</group>
                    </group>
                    <notebook>
                        <page name="description_page" string="Description">
                            <field name="description" type="html"/>
                            <div class="oe_clear"/>
                        </page>
                        <page string="Information">
                            <group col="4">
                                <group col="2">
                                    <field name="sequence" groups="base.group_no_one" invisible="1"/>
                                    <field name="partner_id"/>
                                    <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                                    <field name="displayed_image_id" groups="base.group_no_one" invisible="1"/>
                                </group>
                                <group col="2">
                                    <field name="date_assign" groups="base.group_no_one"/>
                                    <field name="date_last_stage_update" groups="base.group_no_one" invisible="1"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

		<record id="view_task_tree_new" model="ir.ui.view">
            <field name="name">project.task.tree.new</field>
            <field name="model">project.task</field>
            <!-- <field eval="2" name="priority"/> -->
            <field name="arch" type="xml">
                <tree editable="bottom" string="Tasks">
                   <field name="name" string="Title"/>
                   <field name="sale_task" invisible="1"/>
                   <field name="message_needaction" invisible="1"/>
                   <field name="order_id"/>
		   			<field name="delivery_date"/>
                   <field name="fix"/>
                   <field name="refinement_data"/>
                   <field name="delivery_billing_adress"/>
                   <field name="vallue_tax_id" string="VAT ID"/>
                   <field name="payment" widget="many2many_tags"/>
		   			<field name="payment_supplier" widget="many2many_tags"/>
                   <field name="digital_sample" widget="many2many_tags"/>
                   <field name="sample" widget="many2many_tags"/>
                   <field name="comment"/>
                   <field name="date_deadline" invisible="context.get('deadline_visible',True)"/>
		   			<button name="open_to_form_view" type="object" string="Open Form" icon="STOCK_INDEX" help="Click to Open Form View"/>
                </tree>
            </field>
        </record>
		<record id="action_orders_task" model="ir.actions.act_window">
			<field name="name">Sales Task</field>
			<field name="res_model">project.task</field>
			<field name="view_mode">kanban,tree,form,calendar,pivot,graph</field>
			<field name="context">{'default_sale_task':True}</field>
			<field name="domain">[('sale_task', '=', True)]</field>
			<field name="search_view_id" ref="project.view_task_search_form"/>
			<field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('order_task_creation.view_task_tree_new')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('order_task_creation.view_task_form_sale')})]"/>
			<field name="help" type="html">
				<p>Odoo's project management allows you to manage the pipeline of your tasks efficiently. You can track progress, discuss on tasks, attach documents, etc.</p>
			</field>
		</record>

		<menuitem action="action_orders_task"
		id="menu_order_task" parent="base.menu_sales"
		sequence="12" groups="base.group_sale_salesman,base.group_sale_manager"/>

		<!-- To hide progress bar field on sales task-->
<!-- 	       <record model="ir.ui.view" id="view_task_form2_order_task_inherited">
	            <field name="name">project.task.form.order.task.inherited</field>
	            <field name="model">project.task</field>
                    <field name="inherit_id" ref="project_timesheet.view_task_form2_inherited" />
                    <field name="arch" type="xml">
            	       <xpath expr="//field[@name='progress']" position='attributes'>
            		    <attribute name="attrs">{'invisible': [('sale_task', '=', True)]}</attribute>
            	       </xpath>
                    </field>
              </record> -->

		<!-- -->

        <record id="task_type_edit_inherit" model="ir.ui.view">
            <field name="name">project.task.type.inherit.form</field>
            <field name="model">project.task.type</field>
            <field name="inherit_id" ref="project.task_type_edit"/>
            <field name="priority">99</field>
            <field name="arch" type="xml">
            	<xpath expr="//field[@name='sequence']" position="after">
            		<field name ="sales_stage"/>
            	</xpath>
            </field>
        </record>

	</data>
</openerp>
